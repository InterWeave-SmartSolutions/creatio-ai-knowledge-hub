<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-8.2 docs-doc-page docs-doc-id-undefined" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>Customize emails | Creatio Academy</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://academy.creatio.com/docs/8.x/dev/img/OG-Creatio-Docs.jpg><meta data-rh=true name=twitter:image content=https://academy.creatio.com/docs/8.x/dev/img/OG-Creatio-Docs.jpg><meta data-rh=true property=og:url content=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/emails/overview><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=8.2><meta data-rh=true name=docusaurus_tag content=docs-default-8.2><meta data-rh=true name=docsearch:version content=8.2><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-8.2><meta data-rh=true property=og:title content="Customize emails | Creatio Academy"><meta data-rh=true name=description content="The functionality is relevant to Classic UI."><meta data-rh=true property=og:description content="The functionality is relevant to Classic UI."><link data-rh=true rel=icon href=/docs/8.x/dev/img/favicon.ico><link data-rh=true rel=canonical href=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/emails/overview><link data-rh=true rel=alternate href=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/emails/overview hreflang=en><link data-rh=true rel=alternate href=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/emails/overview hreflang=x-default><link rel=preconnect href=https://www.googletagmanager.com><script>window.dataLayer=window.dataLayer||[],function(e,t,a,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var d=t.getElementsByTagName(a)[0],g=t.createElement(a);g.async=!0,g.src="https://www.googletagmanager.com/gtm.js?id="+r+("dataLayer"!=n?"&l="+n:""),d.parentNode.insertBefore(g,d)}(window,document,"script","dataLayer","GTM-5C6KM9TP")</script><link rel=stylesheet href=/docs/8.x/dev/assets/css/styles.89ecc891.css><script src=/docs/8.x/dev/assets/js/runtime~main.1fca6f6f.js defer></script><script src=/docs/8.x/dev/assets/js/main.020f5612.js defer></script><body class=navigation-with-keyboard><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5C6KM9TP" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript>


<script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/docs/8.x/dev/img/logo-white.svg><link rel=preload as=image href=/docs/8.x/dev/img/logo.svg><link rel=preload as=image href=/docs/8.x/dev/img/accelerate.svg><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><div class=navtop><div class=container-fluid><div class=navtop__content><div class=search><form method=get><input class=search__input type=text placeholder=Search name=search><input class=search__button type=submit value=Search></form><div class=search__toggle></div></div><ul class=sites><li class=sites__item><a href=https://www.creatio.com/ rel=nofollow target=_blank>Creatio</a><li class=sites__item><a href=https://community.creatio.com/ rel=nofollow target=_blank>Community</a><li class=sites__item><a href=https://marketplace.creatio.com/ rel=nofollow target=_blank>Marketplace</a><li class=sites__item><a href=https://knowledge-hub.creatio.com/ rel=nofollow target=_blank>Knowledge Hub</a></ul></div></div></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class="navbar__inner container-fluid"><div class=navbar__items><div class=navbar__toggle><span></span></div><a class="navbar__brand navbar__brand_mobile" href=/><img src=/docs/8.x/dev/img/logo-white.svg alt="Creatio Academy"></a><a class=navbar__brand href=/><img src=/docs/8.x/dev/img/logo.svg alt="Creatio Academy"></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/docs/8.x/dev/>Guides</a><a href=https://academy.creatio.com/e-learning target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">E-learning</a><a href=https://academy.creatio.com/training target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Training</a><a href=https://academy.creatio.com/certification target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Certification</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/emails/overview>8.2</a><ul class=dropdown__menu><li><a class=dropdown__link href=/docs/8.x/dev/development-on-creatio-platform/platform-customization/classic-ui/emails/overview>8.3</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/emails/overview>8.2</a><li><a class=dropdown__link href=/docs/8.x/dev/development-on-creatio-platform/8.1/platform-customization/classic-ui/emails/overview>8.1</a><li><a class=dropdown__link href=/docs/8.x/dev/development-on-creatio-platform/8.0/platform-customization/classic-ui/emails/overview>8.0</a></ul></div></div><div class="navbar__items navbar__items--right"><div class=search><form method=get><input class=search__input type=text placeholder=Search name=search><input class=search__button type=submit value=Search></form><div class=search__toggle></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_bSxm><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=container-fluid><div class=docRoot_cWv0><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="doc-menu sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/getting-started>Getting started</a><button aria-label="Expand sidebar category 'Getting started'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/architecture>Architecture</a><button aria-label="Expand sidebar category 'Architecture'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/development-tools>Development tools</a><button aria-label="Expand sidebar category 'Development tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/back-end-development>Back-end development</a><button aria-label="Expand sidebar category 'Back-end development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/front-end-development>Front-end development</a><button aria-label="Expand sidebar category 'Front-end development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/platform-customization>Platform customization</a><button aria-label="Collapse sidebar category 'Platform customization'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/freedom-ui-customization>Freedom UI</a><button aria-label="Expand sidebar category 'Freedom UI'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/classic-ui-1>Classic UI</a><button aria-label="Collapse sidebar category 'Classic UI'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/detail>Detail</a><button aria-label="Expand sidebar category 'Detail'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/marketing-campaigns>Marketing campaigns</a><button aria-label="Expand sidebar category 'Marketing campaigns'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/telephony>Telephony</a><button aria-label="Expand sidebar category 'Telephony'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/machine-learning>Machine learning</a><button aria-label="Expand sidebar category 'Machine learning'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/emails-1>Emails</a><button aria-label="Collapse sidebar category 'Emails'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/emails/overview>Overview</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/emails-customization-examples>Examples</a><button aria-label="Expand sidebar category 'Examples'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/platform-customization/classic-ui/task-scheduler>Task scheduler</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/interface-control-tools>Interface control tools</a><button aria-label="Expand sidebar category 'Interface control tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/integrations-tools>Integrations tools</a><button aria-label="Expand sidebar category 'Integrations tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/mobile-app-development>Mobile app development</a><button aria-label="Expand sidebar category 'Mobile app development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_z5aJ"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This is documentation for Creatio <b>8.2</b>.</div><div class=margin-top--md>For up-to-date documentation, see the <b><a href=/docs/8.x/dev/development-on-creatio-platform/platform-customization/classic-ui/emails/overview>latest version</a></b> (<!-- -->8.3<!-- -->).</div></div><div class=docItemContainer_c0TR><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/docs/8.x/dev/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/platform-customization><span itemprop=name>Platform customization</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/classic-ui-1><span itemprop=name>Classic UI</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/emails-1><span itemprop=name>Emails</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Overview</span><meta itemprop=position content=4></ul></nav><div class=creatio-tags><div class=creatio-tags__content><span class="theme-doc-version-badge badge badge--secondary">Version: 8.2</span></div></div><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Customize emails</h1></header><div class=difficulty-level><span class=difficulty-level-intermediate>Level: <!-- -->intermediate</span></div>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class=admonitionHeading_TMsN>note</div><div class=admonitionContent_vXIg><p>The functionality is relevant to Classic UI.</div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-1365-1>Junk case custom filtering<a href=#title-1365-1 class=hash-link aria-label="Direct link to Junk case custom filtering" title="Direct link to Junk case custom filtering">​</a></h2>
<p>Creatio users can filter unwanted cases by creating a list of email addresses and domains for automatic spam detection. Incoming cases from these domains or addresses are either not registered at all or have the "Canceled" status (the default status value is set in the <strong>Junk Case Default Status</strong> system setting).</p>
<p>Junk filter enables email header analysis based on certain flags, e.g. <code>Auto-Submitted</code>. Emails with those flags are either not registered or register with the pre-defined initial status, set in system settings.</p>
<p>To analyze email addresses and domains, simply add the required value to the <strong>Blacklist of email addresses and domains for case registration</strong> lookup. The emails will be marked as blacklisted during the analysis when you populate the lookup with values (their type is set automatically).</p>
<p>Email analysis is done through the <strong>Email header properties management</strong> lookup. Follow these steps to add a new analysis property:</p>
<ol>
<li>Add a new class that implements the <code>IHeaderPropertyHandler</code> interface. This interface contains a single <code>Check()</code> method that returns a value of <code>bool</code> type. Check the property value and return the result during the <code>Check()</code> method implementation. If the method returns <code>true</code>, the system creates the case using the standard mechanism, if <code>false</code>, the system treats the email as blacklisted.</li>
<li>Add an [Email header properties management] lookup value. Specify the property name used for analysis in the <code>Name</code> column. Specify the class name (added in the previous paragraph) in the <code>handler</code> column.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-1369-1>Working with email threads<a href=#title-1369-1 class=hash-link aria-label="Direct link to Working with email threads" title="Direct link to Working with email threads">​</a></h2>
<p>The mechanism for creating email threads is available in Creatio since version 7.10.0. The main purpose of this mechanism is to improve the email interface. Use this mechanism to easily find email connections, e.g. by copying the connections of the previous email.</p>
<p>The thread construction mechanism is based on the <code>In-Reply-To</code> email header data. According to generally accepted agreements, this header should contain the <code>Message-ID</code> email identifier. The Creatio application retrieves these headers from the synchronized Email service (IMAP / Exchange).</p>
<p>The mechanism can be divided into two logical parts – creating threads and populating activity connection fields.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=title-1369-2>Creating email threads<a href=#title-1369-2 class=hash-link aria-label="Direct link to Creating email threads" title="Direct link to Creating email threads">​</a></h3>
<p>The <code>EmailMessageData</code> detail contains 3 fields:</p>
<ul>
<li><code>MessageId</code> – a string of 500 characters in length;</li>
<li><code>InReplyTo</code> – a string of 500 characters in length;</li>
<li><code>ParentMessageId</code> – a lookup field that references the <code>EmailMessageData</code> detail.</li>
</ul>
<p>The <code>MessageId</code> and <code>InReplyTo</code> fields are populated with the corresponding message header values during synchronization.</p>
<p>The <code>ParentMessageId</code> field is populated with the following values:</p>
<ol>
<li>The <code>EmailMessageData</code> table searches for records where <code>MessageId</code> is identical to <code>InReplyTo</code>. The first found record is set as the current <code>ParentMessageId</code>.</li>
<li>The <code>ParentMessageId</code> field is populated with the current <code>Id</code> value in all <code>EmailMessageData</code> records if the <code>InReplyTo</code> field of these records is identical to the <code>MessageId</code> field<code>.</code></li>
</ol>
<p>Email thread connections are updated for every email.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=title-1369-3>Copying previous email connections in a thread<a href=#title-1369-3 class=hash-link aria-label="Direct link to Copying previous email connections in a thread" title="Direct link to Copying previous email connections in a thread">​</a></h3>
<p>Spreading activity connections across the thread upon adding an email. The <strong>Case</strong> field is used in this case.</p>
<p>A parent record with the activity that includes the populated <strong>Contact</strong> field is searched for the current <code>EmailMessageData</code> record. The <strong>Case</strong> field values from this activity will be spread across the thread. Starting with the found <code>EmailMessageData</code> record, all child <code>EmailMessageData</code> records are found and their <strong>Case</strong> field value is updated.</p>
<p>View a thread with 3 emails in the table below.</p>
<table><tr><th><p>ActivityId<th><p>Title<th><p>CaseId<th><p>EmailMessageId<th><p>EmailMessageParentId<tr><td><p>28BD6D59-B9D7-4FF9-89F5-FEE1DD003912<td><p>Re: relation<td><p>NULL<td><p>66812FBF-411B-4FE0-94C9-1E70FBBEB2D3<td><p>F05B529D-C98C-4E26-BE00-21F8721AEF58<tr><td><p>DC0A40D4-700A-40EB-B394-90E0376C3B5D<td><p>Re: relation<td><p>1C6E18E3-48B1-495E-8EF9-ACA35DB9DE0B<td><p>F05B529D-C98C-4E26-BE00-21F8721AEF58<td><p>E1A0120E-B7C0-4261-9DE0-C63341BF1E0B<tr><td><p>D7A9B82C-ED46-437C-980A-B2650D4FF3DA<td><p>relation<td><p>906909E8-4D64-47FD-AF92-B65B0826AEC3<td><p>E1A0120E-B7C0-4261-9DE0-C63341BF1E0B<td><p>NULL</table>
<p>View the another email is received in the thread in the table below.</p>
<table><tr><th><p>ActivityId<th><p>Title<th><p>CaseId<th><p>EmailMessageId<th><p>EmailMessageParentId<tr><td><p>6623B052-73AD-4AE5-AE61-A6F9BCD930A0<td><p>Re: relation<td><p>NULL<td><p>60C00B01-D0BF-40F6-923E-1830E433AEA1<td><p>66812FBF-411B-4FE0-94C9-1E70FBBEB2D3<tr><td><p>28BD6D59-B9D7-4FF9-89F5-FEE1DD003912<td><p>Re: relation<td><p>NULL<td><p>66812FBF-411B-4FE0-94C9-1E70FBBEB2D3<td><p>F05B529D-C98C-4E26-BE00-21F8721AEF58<tr><td><p>DC0A40D4-700A-40EB-B394-90E0376C3B5D<td><p>Re: relation<td><p>1C6E18E3-48B1-495E-8EF9-ACA35DB9DE0B<td><p>F05B529D-C98C-4E26-BE00-21F8721AEF58<td><p>E1A0120E-B7C0-4261-9DE0-C63341BF1E0B<tr><td><p>D7A9B82C-ED46-437C-980A-B2650D4FF3DA<td><p>relation<td><p>906909E8-4D64-47FD-AF92-B65B0826AEC3<td><p>E1A0120E-B7C0-4261-9DE0-C63341BF1E0B<td><p>NULL</table>
<p>Starting with the record in which <code>EmailMessageId</code> is "60C00B01-D0BF-40F6-923E-1830E433AEA1", a record with the populated <code>CaseId</code> column is searched (does not contain <code>NULL</code>). This is a record where <code>EmailMessageId</code> = "F05B529D-C98C-4E26-BE00-21F8721AEF58", and <code>CaseId</code> = "1C6E18E3-48B1-495E-8EF9-ACA35DB9DE0B".</p>
<p>Now, starting with the record in which <code>EmailMessageId</code> is "F05B529D-C98C-4E26-BE00-21F8721AEF58", Creatio updates the value of the <code>CaseId</code> field for the connected records throughout the thread.</p>
<table><tr><th><p>ActivityId<th><p>Title<th><p>CaseId<th><p>EmailMessageId<th><p>EmailMessageParentId<tr><td><p>6623B052-73AD-4AE5-AE61-A6F9BCD930A0<td><p>Re: relation<td><p>1C6E18E3-48B1-495E-8EF9-ACA35DB9DE0B<td><p>60C00B01-D0BF-40F6-923E-1830E433AEA1<td><p>66812FBF-411B-4FE0-94C9-1E70FBBEB2D3<tr><td><p>28BD6D59-B9D7-4FF9-89F5-FEE1DD003912<td><p>Re: relation<td><p>1C6E18E3-48B1-495E-8EF9-ACA35DB9DE0B<td><p>66812FBF-411B-4FE0-94C9-1E70FBBEB2D3<td><p>F05B529D-C98C-4E26-BE00-21F8721AEF58<tr><td><p>DC0A40D4-700A-40EB-B394-90E0376C3B5D<td><p>Re: relation<td><p>1C6E18E3-48B1-495E-8EF9-ACA35DB9DE0B<td><p>F05B529D-C98C-4E26-BE00-21F8721AEF58<td><p>E1A0120E-B7C0-4261-9DE0-C63341BF1E0B<tr><td><p>D7A9B82C-ED46-437C-980A-B2650D4FF3DA<td><p>relation<td><p>906909E8-4D64-47FD-AF92-B65B0826AEC3<td><p>E1A0120E-B7C0-4261-9DE0-C63341BF1E0B<td><p>NULL</table>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class=admonitionHeading_TMsN>note</div><div class=admonitionContent_vXIg><p>Mail servers sometimes send out letters in the wrong sequence, disregarding the way they were written in the thread<p>(e.g. during synchronization, emails are received first from the inbox and then from the outbox). This complicates the mechanism. Building a thread for the emails that were not received consistently is impossible during synchronization. In that case, a thread can be built once the synchronization is complete. If certain mailbox folders are not loaded, or if the conversation was interrupted by other participants, the thread search logic may not work. However, the thread can be built when all emails are downloaded from the inbox in most cases.</div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=title-1369-4>Recommendations for adding a custom search process for all thread connections after downloading an email<a href=#title-1369-4 class=hash-link aria-label="Direct link to Recommendations for adding a custom search process for all thread connections after downloading an email" title="Direct link to Recommendations for adding a custom search process for all thread connections after downloading an email">​</a></h3>
<p>Use the following guidelines to start working on a new email after thread formation:</p>
<ol>
<li>The <code>Id</code> field of the synchronization session appears in the <code>EmailMessageData</code> table (the values are unique for all synchronization processes). This field is populated only for synchronized emails.</li>
<li>A record is added to the new <code>FinishedSyncSession</code> table if at least one email was received during synchronization.</li>
<li>Certain processes that responded to the signal of saving activities now respond to the (<code>Inserted</code>) insertion signal of the <code>FinishedSyncSession</code> object. Emails from <code>EmailMessageData</code> are selected based on the synchronization session <code>Id</code>. The <code>MailboxSyncSettings</code> field of the <code>EmailMessageData</code> object can be used to select Email messages from the service box.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-1376-1>Macro handler in the email template<a href=#title-1376-1 class=hash-link aria-label="Direct link to Macro handler in the email template" title="Direct link to Macro handler in the email template">​</a></h2>
<p>The email templates can be used for communication with a service team. They are available in the <strong>Email templates</strong> lookup.</p>
<p>For example, the <strong>Case closure notification</strong> template is used to notify the user that the case has been closed. A number of pre-set macros can be used to display the values of some system object columns in the emails (for example contact's title or job).</p>
<p>Creatio enables to implement a custom logic of adding values that is returned by the macro handler. During the processing of the macro the Creatio will execute the algorithm implemented by the developer instead of the basic logic.</p>
<p>The <code>@Invoke</code> tag points on the specific handler of a class. After that, the name of the class that implements the <code>IMacrosInvokable</code> interface with the <code>GetMacrosValue()</code> method should be specified after ".." This method will return the string that replaces the macro string.</p>
<p>To implement custom macro handler:</p>
<ol>
<li>Create class that implements the <code>IMacrosInvokable</code> interface.</li>
<li>Register a macro in the <code>EmailTemplateMacros</code> table by specifying the <code>ParentId</code> (base template with the <code>@Invoke</code> tag) and the <code>ColumnPath</code> (class name).</li>
<li>Add a macro to the email template</li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/8.x/dev/development-on-creatio-platform/8.2/category/emails-1><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Emails</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/8.x/dev/development-on-creatio-platform/8.2/emails-customization-examples><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Examples</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#title-1365-1 class="table-of-contents__link toc-highlight">Junk case custom filtering</a><li><a href=#title-1369-1 class="table-of-contents__link toc-highlight">Working with email threads</a><ul><li><a href=#title-1369-2 class="table-of-contents__link toc-highlight">Creating email threads</a><li><a href=#title-1369-3 class="table-of-contents__link toc-highlight">Copying previous email connections in a thread</a><li><a href=#title-1369-4 class="table-of-contents__link toc-highlight">Recommendations for adding a custom search process for all thread connections after downloading an email</a></ul><li><a href=#title-1376-1 class="table-of-contents__link toc-highlight">Macro handler in the email template</a></ul></div></div></div></div></main></div></div></div></div><footer class=footer><div class=footer__top><div class="container container-fluid"><div class=footer__cont><div class=footer__logo><img src=/docs/8.x/dev/img/accelerate.svg alt="" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width=271.4 height=38><img src=/docs/8.x/dev/img/accelerate.svg alt="" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width=271.4 height=38></div><div class="row footer__links"><div class="col footer__col"><ul class="footer__items clean-list"><li class=footer__item><a href=https://www.facebook.com/CreatioCompany target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.linkedin.com/company/creatioglobal target=_blank rel="noopener noreferrer" class=footer__link-item>LinkedIn<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.youtube.com/c/creatio target=_blank rel="noopener noreferrer" class=footer__link-item>YouTube<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.twitter.com/Creatio_Global target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.owler.com/company/Creatio target=_blank rel="noopener noreferrer" class=footer__link-item>Owler<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Connect with us</div><ul class="footer__items clean-list"><li class=footer__item><a href="tel:+1 617 765 7997" target=_blank rel="noopener noreferrer" class=footer__link-item>US: +1 617 765 7997</a><li class=footer__item><a href="tel:+44 20 3384 0040" target=_blank rel="noopener noreferrer" class=footer__link-item>UK: +44 20 3384 0040</a><li class=footer__item><a href="tel:+61 261 452 888" target=_blank rel="noopener noreferrer" class=footer__link-item>AU: +61 261 452 888</a></ul></div><div class="col footer__col"><div class=footer__title> </div><ul class="footer__items clean-list"><li class=footer__item><a href=mailto:info@creatio.com target=_blank rel="noopener noreferrer" class=footer__link-item>info@creatio.com</a><li class=footer__item><a href=mailto:info@creatio.com target=_blank rel="noopener noreferrer" class=footer__link-item>support@creatio.com</a></ul></div></div></div></div></div><div class=footer__bottom><div class="container container-fluid"><div class=footer__copyright>© 2025 Creatio. All rights reserved.  |  <a href=https://www.creatio.com/privacy-policy target=_blank>Privacy Policy</a></div></div></div></footer></div>