<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-undefined" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>Microsoft SQL and PostgreSQL script examples | Creatio Academy</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://academy.creatio.com/docs/8.x/dev/img/OG-Creatio-Docs.jpg><meta data-rh=true name=twitter:image content=https://academy.creatio.com/docs/8.x/dev/img/OG-Creatio-Docs.jpg><meta data-rh=true property=og:url content=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Microsoft SQL and PostgreSQL script examples | Creatio Academy"><meta data-rh=true name=description content="Example 1 (views)"><meta data-rh=true property=og:description content="Example 1 (views)"><link data-rh=true rel=icon href=/docs/8.x/dev/img/favicon.ico><link data-rh=true rel=canonical href=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples><link data-rh=true rel=alternate href=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples hreflang=en><link data-rh=true rel=alternate href=https://academy.creatio.com/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples hreflang=x-default><link rel=preconnect href=https://www.googletagmanager.com><script>window.dataLayer=window.dataLayer||[],function(e,t,a,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var d=t.getElementsByTagName(a)[0],g=t.createElement(a);g.async=!0,g.src="https://www.googletagmanager.com/gtm.js?id="+r+("dataLayer"!=n?"&l="+n:""),d.parentNode.insertBefore(g,d)}(window,document,"script","dataLayer","GTM-5C6KM9TP")</script><link rel=stylesheet href=/docs/8.x/dev/assets/css/styles.89ecc891.css><script src=/docs/8.x/dev/assets/js/runtime~main.1fca6f6f.js defer></script><script src=/docs/8.x/dev/assets/js/main.020f5612.js defer></script><body class=navigation-with-keyboard><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5C6KM9TP" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript>


<script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/docs/8.x/dev/img/logo-white.svg><link rel=preload as=image href=/docs/8.x/dev/img/logo.svg><link rel=preload as=image href=/docs/8.x/dev/img/accelerate.svg><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><div class=navtop><div class=container-fluid><div class=navtop__content><div class=search><form method=get><input class=search__input type=text placeholder=Search name=search><input class=search__button type=submit value=Search></form><div class=search__toggle></div></div><ul class=sites><li class=sites__item><a href=https://www.creatio.com/ rel=nofollow target=_blank>Creatio</a><li class=sites__item><a href=https://community.creatio.com/ rel=nofollow target=_blank>Community</a><li class=sites__item><a href=https://marketplace.creatio.com/ rel=nofollow target=_blank>Marketplace</a><li class=sites__item><a href=https://knowledge-hub.creatio.com/ rel=nofollow target=_blank>Knowledge Hub</a></ul></div></div></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class="navbar__inner container-fluid"><div class=navbar__items><div class=navbar__toggle><span></span></div><a class="navbar__brand navbar__brand_mobile" href=/><img src=/docs/8.x/dev/img/logo-white.svg alt="Creatio Academy"></a><a class=navbar__brand href=/><img src=/docs/8.x/dev/img/logo.svg alt="Creatio Academy"></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/docs/8.x/dev/>Guides</a><a href=https://academy.creatio.com/e-learning target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">E-learning</a><a href=https://academy.creatio.com/training target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Training</a><a href=https://academy.creatio.com/certification target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Certification</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current=page class="navbar__link active" aria-haspopup=true aria-expanded=false role=button href=/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples>8.3</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples>8.3</a><li><a class=dropdown__link href=/docs/8.x/dev/development-on-creatio-platform/8.2/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples>8.2</a><li><a class=dropdown__link href=/docs/8.x/dev/development-on-creatio-platform/8.1/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples>8.1</a><li><a class=dropdown__link href=/docs/8.x/dev/development-on-creatio-platform/8.0/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples>8.0</a></ul></div></div><div class="navbar__items navbar__items--right"><div class=search><form method=get><input class=search__input type=text placeholder=Search name=search><input class=search__button type=submit value=Search></form><div class=search__toggle></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_bSxm><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=container-fluid><div class=docRoot_cWv0><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="doc-menu sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/category/getting-started>Getting started</a><button aria-label="Expand sidebar category 'Getting started'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/category/architecture>Architecture</a><button aria-label="Expand sidebar category 'Architecture'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/docs/8.x/dev/development-on-creatio-platform/category/development-tools>Development tools</a><button aria-label="Collapse sidebar category 'Development tools'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/creatio-ide>Creatio IDE</a><button aria-label="Expand sidebar category 'Creatio IDE'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/external-ides>External IDEs</a><button aria-label="Expand sidebar category 'External IDEs'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/packages>Packages</a><button aria-label="Expand sidebar category 'Packages'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/version-control-tools>Version control tools</a><button aria-label="Expand sidebar category 'Version control tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/testing-tools>Testing tools</a><button aria-label="Expand sidebar category 'Testing tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/database-tools>Database tools</a><button aria-label="Collapse sidebar category 'Database tools'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/postgresql-features>PostgreSQL features</a><button aria-label="Collapse sidebar category 'PostgreSQL features'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/overview>Overview</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/database-features-examples>Examples</a><button aria-label="Collapse sidebar category 'Examples'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/postgresql-features/examples/mssql-and-postgresql-script-examples>Script examples</a></ul></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/backward-compatible-sql-scripts>Backward compatible scripts</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/logging-tools>Logging tools</a><button aria-label="Expand sidebar category 'Logging tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/debugging-tools>Debugging tools</a><button aria-label="Expand sidebar category 'Debugging tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" tabindex=0 href=/docs/8.x/dev/development-on-creatio-platform/category/delivery-tools>Delivery tools</a><button aria-label="Expand sidebar category 'Delivery tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/category/back-end-development>Back-end development</a><button aria-label="Expand sidebar category 'Back-end development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/category/front-end-development>Front-end development</a><button aria-label="Expand sidebar category 'Front-end development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/category/platform-customization>Platform customization</a><button aria-label="Expand sidebar category 'Platform customization'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/docs/8.x/dev/development-on-creatio-platform/category/integrations-tools>Integrations tools</a><button aria-label="Expand sidebar category 'Integrations tools'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_z5aJ"><div class=docItemContainer_c0TR><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/docs/8.x/dev/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/8.x/dev/development-on-creatio-platform/category/development-tools><span itemprop=name>Development tools</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/8.x/dev/development-on-creatio-platform/category/database-tools><span itemprop=name>Database tools</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/8.x/dev/development-on-creatio-platform/category/postgresql-features><span itemprop=name>PostgreSQL features</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/docs/8.x/dev/development-on-creatio-platform/database-features-examples><span itemprop=name>Examples</span></a><meta itemprop=position content=4><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Script examples</span><meta itemprop=position content=5></ul></nav><div class=creatio-tags><div class=creatio-tags__content><span class="theme-doc-version-badge badge badge--secondary">Version: 8.3</span></div></div><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Microsoft SQL and PostgreSQL script examples</h1></header><div class=difficulty-level><span class=difficulty-level-intermediate>Level: <!-- -->intermediate</span></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-2139-1>Example 1 (views)<a href=#title-2139-1 class=hash-link aria-label="Direct link to Example 1 (views)" title="Direct link to Example 1 (views)">​</a></h2>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class=admonitionHeading_TMsN>Example</div><div class=admonitionContent_vXIg><p>Example of an SQL script that creates a view and triggers to add, modify, and delete records from the target table.</div></div>
<div class="tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">MicrosoftSQL<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">PostgreSQL</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- View and triggers that let you modify the target table</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- Microsoft SQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> sys</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">views </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> object_id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">N</span><span class="token string" style=color:#e3116c>'[dbo].[VwSysAdminUnit]'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Description</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ContactId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsDirectoryEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZoneId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserPassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AccountId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Active</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LoggedIn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SynchronizeWithLDAP</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryDN</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysCultureId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ProcessListeners</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PasswordExpireDate</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HomePageId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserConnectionTypeId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ForceChangePassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DateTimeFormatId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SessionTimeout</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SessionTimeout</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>LEFT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>LEFT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Code</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZoneId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRIGGER</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ITR_VwSysAdminUnit_I</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    INSTEAD </span><span class="token keyword" style=color:#00009f>OF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> NOCOUNT </span><span class="token keyword" style=color:#00009f>ON</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Description</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ContactId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsDirectoryEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZoneId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserPassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AccountId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Active</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LoggedIn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SynchronizeWithLDAP</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryDN</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysCultureId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ProcessListeners</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PasswordExpireDate</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HomePageId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ForceChangePassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DateTimeFormatId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SessionTimeout</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Description</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ContactId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsDirectoryEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>COALESCE</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Code</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZoneId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>''</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserPassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">ISNULL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AccountId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Active</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">ISNULL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LoggedIn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SynchronizeWithLDAP</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryDN</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysCultureId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ProcessListeners</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PasswordExpireDate</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HomePageId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token keyword" style=color:#00009f>COALESCE</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserConnectionTypeId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">ISNULL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ForceChangePassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DateTimeFormatId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SessionTimeout</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRIGGER</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ITR_VwSysAdminUnit_U</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    INSTEAD </span><span class="token keyword" style=color:#00009f>OF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>UPDATE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> NOCOUNT </span><span class="token keyword" style=color:#00009f>ON</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>UPDATE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Description</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Description</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ContactId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ContactId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsDirectoryEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsDirectoryEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZoneId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>COALESCE</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Code</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZone</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TimeZoneId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>''</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserPassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserPassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AccountId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AccountId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Active</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Active</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LoggedIn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LoggedIn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SynchronizeWithLDAP</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SynchronizeWithLDAP</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntry</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryDN</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">LDAPEntryDN</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysCultureId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysCultureId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ProcessListeners</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ProcessListeners</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PasswordExpireDate</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PasswordExpireDate</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HomePageId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HomePageId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>COALESCE</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserConnectionTypeId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ForceChangePassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ForceChangePassword</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DateTimeFormatId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DateTimeFormatId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SessionTimeout</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SessionTimeout</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">INSERTED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRIGGER</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ITR_VwSysAdminUnit_D</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    INSTEAD </span><span class="token keyword" style=color:#00009f>OF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> NOCOUNT </span><span class="token keyword" style=color:#00009f>ON</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DELETED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DELETED</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- View and triggers that let you modify the target table</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- PostgreSQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ITR_VwSysLookup_IUD_Func"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CASCADE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"VwSysLookup"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"VwSysLookup"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Description"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysFolderId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysGridPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEditPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"VwSysSchemaInfo"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysWorkspaceId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ProcessListeners"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"IsSystem"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"IsSimple"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"VwSysSchemaInfo"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"VwSysSchemaInfo"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"UId"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ITR_VwSysLookup_IUD_Func"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>RETURNS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRIGGER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> $$</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> TG_OP </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INSERT'</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"CreatedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"CreatedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"ModifiedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"ModifiedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"Description"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysFolderId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysGridPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysEditPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"ProcessListeners"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"IsSystem"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"IsSimple"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Description"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysFolderId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysGridPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEditPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ProcessListeners"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"IsSystem"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"IsSimple"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        ELSIF TG_OP </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UPDATE'</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UPDATE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"CreatedOn"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"CreatedById"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"ModifiedOn"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"ModifiedById"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"Description"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Description"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysFolderId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysFolderId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysGridPageSchemaUId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysGridPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysEditPageSchemaUId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEditPageSchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"ProcessListeners"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ProcessListeners"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"IsSystem"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"IsSystem"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"IsSimple"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"IsSimple"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        ELSIF TG_OP </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DELETE'</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> OLD</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> OLD</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> NEW</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$$ </span><span class="token keyword" style=color:#00009f>LANGUAGE</span><span class="token plain"> plpgsql</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRIGGER</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ITR_VwSysLookup_IUD"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    INSTEAD </span><span class="token keyword" style=color:#00009f>OF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>UPDATE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"VwSysLookup"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FOR EACH ROW</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXECUTE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PROCEDURE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ITR_VwSysLookup_IUD_Func"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-2139-2>Example 2 (views)<a href=#title-2139-2 class=hash-link aria-label="Direct link to Example 2 (views)" title="Direct link to Example 2 (views)">​</a></h2>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class=admonitionHeading_TMsN>Example</div><div class=admonitionContent_vXIg><p>Example of an SQL script that demonstrates how to use a RULE instead of the INSTEAD OF trigger in PostgreSQL.</div></div>
<div class="tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Microsoft SQL<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">PostgreSQL</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Use the RULE instead of the INSTEAD OF trigger</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- Microsoft SQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> sys</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">views </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> object_id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">N</span><span class="token string" style=color:#e3116c>'[dbo].[VwAdministrativeObjects]'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwAdministrativeObjects</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwAdministrativeObjects</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>WITH</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>max</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByOperations</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByOperations</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>max</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByColumns</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByColumns</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>max</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByRecords</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByRecords</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>max</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsTrackChangesInDB</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsTrackChangesInDB</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ExtendParent</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'AdministratedByOperations'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByOperations</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ExtendParent</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'AdministratedByColumns'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByColumns</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ExtendParent</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'AdministratedByRecords'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByRecords</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ExtendParent</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'IsTrackChangesInDB'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaProperty</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsTrackChangesInDB</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>LEFT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>OUTER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ExtendParent</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ManagerName</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'EntitySchemaManager'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ExtendParent</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>GROUP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BY</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">CreatedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedOn</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ModifiedById</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysSchemaExtending</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TopExtendingCaption</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> Caption</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Description</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysLookup</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysLookup</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysEntitySchemaUId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsLookup</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysModule</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysModuleEntity</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysModuleEntity</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysModule</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysModuleEntityId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysModuleEntity</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysEntitySchemaUId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsModule</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByOperations</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByColumns</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdministratedByRecords</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsTrackChangesInDB</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysWorkspaceId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ProcessListeners</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSSPEntitySchemaAccessList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSSPEntitySchemaAccessList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">EntitySchemaUId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">IsInSSPEntitySchemaAccessList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchema</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysSchemaExtending</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> BaseSchemas</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwSysSchemaExtending</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysPackage</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>on</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysPackageId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysPackage</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">BaseSchemas</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysSchemaId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRIGGER</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">TRVwAdministrativeObjects_IU</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">VwAdministrativeObjects</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    INSTEAD </span><span class="token keyword" style=color:#00009f>OF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>UPDATE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> NOCOUNT </span><span class="token keyword" style=color:#00009f>ON</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Use the RULE instead of the INSTEAD OF trigger</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- PostgreSQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>public</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"VwAdministrativeObjects"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>RULE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> RU_VwAdministrativeObjects </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"VwAdministrativeObjects"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VIEW</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>public</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"VwAdministrativeObjects"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>WITH</span><span class="token plain"> SysSchemaAdministrationProperties </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Id </span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>MAX</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">AdministratedByOperations</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdministratedByOperations"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>MAX</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">AdministratedByColumns</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdministratedByColumns"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>MAX</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">AdministratedByRecords</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdministratedByRecords"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>MAX</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">IsTrackChangesInDB</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"IsTrackChangesInDB"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> Id</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSchemaProperty"</span><span class="token plain"> ssp</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ExtendParent"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'AdministratedByOperations'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Value"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> AdministratedByOperations</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSchemaProperty"</span><span class="token plain"> ssp</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ExtendParent"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'AdministratedByColumns'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Value"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> AdministratedByColumns</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSchemaProperty"</span><span class="token plain"> ssp</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ExtendParent"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'AdministratedByRecords'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Value"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> AdministratedByRecords</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>,</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSchemaProperty"</span><span class="token plain"> ssp </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ExtendParent"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'IsTrackChangesInDB'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Value"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'True'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> ssp</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> IsTrackChangesInDB</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSchema"</span><span class="token plain"> ss</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>LEFT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>OUTER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSchema"</span><span class="token plain"> DerivedSysSchema </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> DerivedSysSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ExtendParent"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ManagerName"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'EntitySchemaManager'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> ss</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ExtendParent"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> AdministrationPropertiesAll</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>GROUP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BY</span><span class="token plain"> AdministrationPropertiesAll</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Id</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"UId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"UId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"CreatedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedOn"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ModifiedById"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token keyword" style=color:#00009f>public</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"VwSysSchemaExtending"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"TopExtendingCaption"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Caption"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Description"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysLookup"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"UId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"IsLookup"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysModule"</span><span class="token plain"> sm</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysModuleEntity"</span><span class="token plain"> sme </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> sme</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sm</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysModuleEntityId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"UId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sme</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysEntitySchemaUId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"IsModule"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"AdministratedByOperations"</span><span class="token plain">::</span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"AdministratedByColumns"</span><span class="token plain">::</span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"AdministratedByRecords"</span><span class="token plain">::</span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"IsTrackChangesInDB"</span><span class="token plain">::</span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"SysWorkspaceId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ProcessListeners"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>,</span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSSPEntitySchemaAccessList"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"EntitySchemaUId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"UId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"IsInSSPEntitySchemaAccessList"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysSchema"</span><span class="token plain"> BaseSchema</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"VwSysSchemaExtending"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"VwSysSchemaExtending"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"BaseSchemaId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysPackage"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>on</span><span class="token plain"> BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysPackageId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysPackage"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> SysSchemaAdministrationProperties </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> BaseSchema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> SysSchemaAdministrationProperties</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysSchemaId"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>RULE</span><span class="token plain"> RU_VwAdministrativeObjects </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>UPDATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"VwAdministrativeObjects"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DO</span><span class="token plain"> INSTEAD NOTHING</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-2139-3>Example 3 (stored procedures)<a href=#title-2139-3 class=hash-link aria-label="Direct link to Example 3 (stored procedures)" title="Direct link to Example 3 (stored procedures)">​</a></h2>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class=admonitionHeading_TMsN>Example</div><div class=admonitionContent_vXIg><p>Example of an SQL script that creates a stored procedure. The stored procedure uses loops, cursors, and temporary tables.</div></div>
<div class="tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Microsoft SQL<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">PostgreSQL</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Stored procedure that uses loops, cursors, and temporary tables</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- Microsoft SQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'[dbo].[tsp_ActualizeUserRoles]'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PROCEDURE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_ActualizeUserRoles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PROCEDURE</span><span class="token plain"> dbo</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">tsp_ActualizeUserRoles </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"> uniqueidentifier</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> NOCOUNT </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'tempdb..#AdminUnitListTemp'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitListTemp];</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitListTemp] (</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> NVARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Granted</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@GetAdminUnitList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> nvarchar</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>260</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@OldUserRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> nvarchar</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>260</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersBeforeActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersAfterActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StillManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NoLongerManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token plain"> uniqueidentifier</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Old user roles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@OldUserRoles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Old user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersBeforeActualization</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@OldUserRoles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token variable" style=color:#36acaa>@OldUserRoles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Get and insert new user roles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@GetAdminUnitList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_GetAdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@GetAdminUnitList</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewRoles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- User managers after actualization</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersAfterActualization</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewRoles</span><span class="token plain"> NewRoles</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> NewRoles</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Roles</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- New (who were not but become) user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewManagers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersAfterActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> managersAfterActualization</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersBeforeActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> managersBeforeActualization</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> managersBeforeActualization</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> managersAfterActualization</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Add all user roles to new managers and their grantee-users, if they arent already have</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewManagers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GranteeSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitGrantedRight</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> newManagers</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitGrantedRight</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> newManagers</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> Roles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>OPEN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WHILE</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@FETCH_STATUS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> newRoles</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> newRoles</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CLOSE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DEALLOCATE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@isUserLostAtLeastOneRole</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>COUNT</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>*</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@OldUserRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> oldUserRoles</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> newUserRoles</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> newUserRoles</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> oldUserRoles</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Still (who were and remained) user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StillManagers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> managersAfterActualization</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersAfterActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> managersAfterActualization</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersBeforeActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> managersBeforeActualization</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> managersAfterActualization</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> managersBeforeActualization</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- If user lost at least one role, we need to actualize all his still-managers.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- If not (user only gained new roles) - we just add to still-managers and their grantee-users new user roles.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@isUserLostAtLeastOneRole</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>-- Add all new user roles to his still-managers and to their grantee-users</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> stillManagers</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StillManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> stillManagers</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GranteeSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitGrantedRight</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StillManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> stillManagers</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> stillManagers</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> Roles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>OPEN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHILE</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@FETCH_STATUS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewRoles</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> newRoles</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> newRoles</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>CLOSE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>DEALLOCATE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>--Actualize all roles for still-managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StillManagers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GranteeSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitGrantedRight</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StillManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> stillManagers</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> stillManagers</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>OPEN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHILE</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@FETCH_STATUS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitRoles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitRoles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_GetAdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRAN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SysAdminUnitId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitRoles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>COMMIT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>CLOSE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>DEALLOCATE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- No longer (who were but not remained) user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NoLongerManagers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersBeforeActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> managersBeforeActualization</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ManagersAfterActualization</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> managersAfterActualization</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> managersAfterActualization</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> managersBeforeActualization</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Actualize roles for all noLonger-managers, his grantee-users and all grantee-users of user</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NoLongerManagers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GranteeSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitGrantedRight</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NoLongerManagers</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> noLongerManagers</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> noLongerManagers</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> GranteeSysAdminUnitId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> SysAdminUnitGrantedRight</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> GrantorSysAdminUnitId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> Roles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>OPEN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WHILE</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@FETCH_STATUS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitRoles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitRoles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_GetAdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TRAN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SysAdminUnitId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SysAdminUnitRoleId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitRoles</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>COMMIT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CLOSE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DEALLOCATE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getUserAdminUnits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'tempdb..#AdminUnitListTemp'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitListTemp];</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Stored procedure that uses loops, cursors, and temporary tables</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- PostgreSQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"tsp_ActualizeUserRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"tsp_ActualizeUserRoles"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    UserId UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>RETURNS</span><span class="token plain"> VOID</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> $$</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    getUserNewManagers </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GranteeSysAdminUnitId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitGrantedRight"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewManagers"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitGrantedRight"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"GrantorSysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newManagers"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    lostUserRolesCount </span><span class="token keyword" style=color:#00009f>INT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    getUserStillManagers </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"stillManagers"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"StillManagers"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"stillManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GranteeSysAdminUnitId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitGrantedRight"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"StillManagers"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"stillManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"stillManagers"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GrantorSysAdminUnitId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    getUserNoLongerManagers </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NoLongerManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GranteeSysAdminUnitId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitGrantedRight"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NoLongerManagers"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"noLongerManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"noLongerManagers"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GrantorSysAdminUnitId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GranteeSysAdminUnitId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitGrantedRight"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GrantorSysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GetAdminUnitListTmp"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GetAdminUnitListTmp"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Old user roles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OldUserRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OldUserRoles"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OldUserRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Old user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersBeforeActualization"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersBeforeActualization"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersBeforeActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysUserId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OldUserRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OldUserRoles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Get and insert new user roles</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GetAdminUnitList"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GetAdminUnitList"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"tsp_GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> UserId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- User managers after actualization</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersAfterActualization"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersAfterActualization"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersAfterActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysUserId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Roles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- New (who were not but become) user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewManagers"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewManagers"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersAfterActualization"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersAfterActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersBeforeActualization"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersBeforeActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersBeforeActualization"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersAfterActualization"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Add all user roles to new managers and their grantee-users, if they arent already have</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"> UserNewManager </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> getUserNewManagers </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXIT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> UserNewManager </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> UserNewManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserNewManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newRoles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>COUNT</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>*</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> lostUserRolesCount</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OldUserRoles"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"oldUserRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newUserRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newUserRoles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"oldUserRoles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Still (who were and remained) user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"StillManagers"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"StillManagers"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"StillManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersAfterActualization"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersAfterActualization"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersAfterActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersBeforeActualization"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersBeforeActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersAfterActualization"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersBeforeActualization"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- If user lost at least one role, we need to actualize all his still-managers.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- If not (user only gained new roles) - we just add to still-managers and their grantee-users new user roles.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> lostUserRolesCount </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>-- Add all new user roles to his still-managers and to their grantee-users</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"> UserStillManager </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> getUserStillManagers </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>EXIT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> UserStillManager </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> UserStillManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NewRoles"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserStillManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"newRoles"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>--Actualize all roles for still-managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"> UserStillManager </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> getUserStillManagers </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>EXIT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> UserStillManager </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"tsp_GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">UserStillManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserStillManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> UserStillManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- No longer (who were but not remained) user managers</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NoLongerManagers"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NoLongerManagers"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NoLongerManagers"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersBeforeActualization"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersBeforeActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ManagersAfterActualization"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersAfterActualization"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersAfterActualization"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"managersBeforeActualization"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- Actualize roles for all noLonger-managers, his grantee-users and all grantee-users of user</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"> UserNoLongerManager </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> getUserNoLongerManagers </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXIT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> UserNoLongerManager </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"tsp_GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">UserNoLongerManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>DELETE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserNoLongerManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitInRole"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"SysAdminUnitId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoleId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> UserNoLongerManager</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitRoles"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"GetAdminUnitListTmp"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$$ </span><span class="token keyword" style=color:#00009f>LANGUAGE</span><span class="token plain"> plpgsql</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-2139-4>Example 4 (stored procedures)<a href=#title-2139-4 class=hash-link aria-label="Direct link to Example 4 (stored procedures)" title="Direct link to Example 4 (stored procedures)">​</a></h2>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class=admonitionHeading_TMsN>Example</div><div class=admonitionContent_vXIg><p>Example of a recursive stored procedure that returns a table and uses <code>PERFORM</code>.</div></div>
<div class="tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Microsoft SQL<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">PostgreSQL</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Recursive stored procedure that returns a table and uses PERFORM:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- Microsoft SQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'[dbo].[tsp_GetAdminUnitList]'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PROCEDURE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_GetAdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PROCEDURE</span><span class="token plain"> dbo</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">tsp_GetAdminUnitList </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"> uniqueidentifier</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Granted</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> NOCOUNT </span><span class="token keyword" style=color:#00009f>ON</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StartNestedLevel</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> object_id</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'tempdb..#AdminUnitList'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> NVARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> uniqueidentifier </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Granted</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>Level</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StartNestedLevel</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@NESTLEVEL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ConnectionType</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> SysAdminUnit </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>-- #AdminUnitListTemp should be created in tsp_ActualizeUserRoles or in tsp_ActualizeAdminUnitInRole</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@IsAdminUnitListTempExists</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'tempdb..#AdminUnitListTemp'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@IsAdminUnitListTempExists</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WITH</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>6</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ConnectionType</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> userInRole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sau </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> userInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> userInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">userInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sau </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectStartLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        userInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> userInRole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sau </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> userInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysFuncRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysFuncRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">OrgRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>level</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> hierSelect </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">hierSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleHierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">StartLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysFuncRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> funcRoleInOrgRole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> hierSelect </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> funcRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">OrgRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> hierSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> funcRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">StartLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>level</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleHierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> funcRoleHierSelect </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">funcRoleHierSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DependentUserSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                mainSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                mainSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                mainSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> mainSelect</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> userInRole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> mainSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> userInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AllUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AllUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> userInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sau</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AllUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList] ([Id], [Name], [ParentRoleId], [Granted], [Level])</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token variable" style=color:#36acaa>@Granted</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            @</span><span class="token variable" style=color:#36acaa>@NESTLEVEL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleHierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DependentUserSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@alreadyGotRolesForThisUser</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>bit</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@IsAdminUnitListTempExists</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@alreadyGotRolesForThisUser</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> CAST</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitListTemp]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@alreadyGotRolesForThisUser</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList] ([Id], [Name], [ParentRoleId], [Granted], [Level])</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token variable" style=color:#36acaa>@Granted</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    @</span><span class="token variable" style=color:#36acaa>@NESTLEVEL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitListTemp] WHERE UserId = @UserId;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WITH</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>6</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ConnectionType</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ConnectionType</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sysUserInRole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sau </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sysUserInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sysUserInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">sysUserInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Chief</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> ChiefUnitsSelect</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sau </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectStartLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> RoleId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> RoleId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> RoleId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> RoleId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysFuncRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysFuncRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">OrgRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> Roles</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> Roles</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">RoleId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectStartLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>level</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> hierSelect </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">hierSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SelectPriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleHierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">StartLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysFuncRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> funcRoleInOrgRole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> hierSelect </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> funcRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">OrgRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> hierSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> funcRoleInOrgRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">StartLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleHierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> funcRolesHierSelect </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">funcRolesHierSelect</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PriorLevel</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DependentUserSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>Level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sysUserInRole</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">MainSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sysUserInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AllUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AllUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> sysUserInRole</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ChiefUnitsSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> sau</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                                </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserInRole</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysUserId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                                </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">UserUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AllUnits</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitListTemp ([UserId], [Id], [Name], [ParentRoleId], [Granted])</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token variable" style=color:#36acaa>@Granted</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">HierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">FuncRoleHierarchicalSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">DependentUserSelect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList] ([Id], [Name], [ParentRoleId], [Granted], [Level])</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token variable" style=color:#36acaa>@Granted</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                @</span><span class="token variable" style=color:#36acaa>@NESTLEVEL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitListTemp] WHERE UserId = @UserId;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUserId</span><span class="token plain"> uniqueidentifier</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUsersList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUsersList</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList].[Id]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList].[Id] = [SysAdminUnit].[Id]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnit</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList].[Id] &lt;> @UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList].[Granted] &lt;> 1 AND [#AdminUnitList].[Level] >= @@NESTLEVEL;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>OPEN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUsersList</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUsersList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUserId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WHILE</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@FETCH_STATUS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_GetAdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>@DependentUserId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Granted</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUsersList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUserId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CLOSE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUsersList</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DEALLOCATE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@DependentUsersList</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@GrantorSysAdminUnitId</span><span class="token plain"> uniqueidentifier</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getGrantorSysAdminUnitList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getGrantorSysAdminUnitList</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">SysAdminUnitGrantedRight</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">GranteeSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList] WHERE [Id] = @UserId AND [Granted] = 1 AND [Level] &lt; @@NESTLEVEL);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>OPEN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getGrantorSysAdminUnitList</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getGrantorSysAdminUnitList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WHILE</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@FETCH_STATUS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_GetAdminUnitList</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@UserId</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>@GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Granted</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FETCH</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>NEXT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getGrantorSysAdminUnitList</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CLOSE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getGrantorSysAdminUnitList</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DEALLOCATE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@getGrantorSysAdminUnitList</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> @</span><span class="token variable" style=color:#36acaa>@NESTLEVEL</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@StartNestedLevel</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WITH</span><span class="token plain"> QQ </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SysAdminUnitTypeValue</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>as</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"> adminUnitList</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                adminUnitList</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                adminUnitList</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">SysAdminUnitTypeValue</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token comment" style=color:#999988;font-style:italic>#AdminUnitList] adminUnitList</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> SysAdminUnit sau </span><span class="token keyword" style=color:#00009f>on</span><span class="token plain"> sau</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">Id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> adminUnitList</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Id</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Name</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">ParentRoleId</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> QQ</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>ORDER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BY</span><span class="token plain"> SysAdminUnitTypeValue </span><span class="token keyword" style=color:#00009f>DESC</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Recursive stored procedure that returns a table and uses PERFORM:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- PostgreSQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"tsp_GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"tsp_GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    UserId UUID</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    IsGranted </span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    NestLevel </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>RETURNS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> UUID</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> $$</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ConnectionType </span><span class="token keyword" style=color:#00009f>INT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    IsAdminUnitListTempExists </span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    DependentUserId UUID</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    DependentUsersList </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;></span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Granted"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>>=</span><span class="token plain"> NestLevel</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    GrantorSysAdminUnitId UUID</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    GetGrantorSysAdminUnitList </span><span class="token keyword" style=color:#00009f>CURSOR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"GrantorSysAdminUnitId"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnitGrantedRight"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"GranteeSysAdminUnitId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Granted"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>TRUE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> NestLevel</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    ParentRoleId UUID </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> NestLevel </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMPORARY</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> UUID</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>250</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> UUID</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"Granted"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ConnectionType"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> ConnectionType </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WITH</span><span class="token plain"> RECURSIVE </span><span class="token string" style=color:#e3116c>"MainSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>6</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ConnectionType"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ConnectionType</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"ChiefUnitsSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"chief"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysUserId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"chief"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"chief"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysRoleId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"chief"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"chief"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"chief"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"chief"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"chief"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"ChiefUnitsSelect"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ChiefUnitsSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"HierarchicalSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SelectStartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SelectStartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SelectStartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"MainSelect"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SelectStartLevel"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SelectStartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysUserId"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ChiefUnitsSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ChiefUnitsSelect"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"FuncRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"SysFuncRoleInOrgRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token string" style=color:#e3116c>"SysFuncRoleInOrgRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"OrgRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SelectPriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SelectPriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SelectPriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"level"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"MainSelect"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SelectPriorLevel"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"HierarchicalSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"hierSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"hierSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SelectPriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"FuncRoleHierarchicalSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"StartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"StartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"StartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"MainSelect"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"StartLevel"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysFuncRoleInOrgRole"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"funcRoleInOrgRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"HierarchicalSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"hierSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"funcRoleInOrgRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"OrgRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"hierSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"funcRoleInOrgRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"FuncRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"StartLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"PriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"PriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"PriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"level"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"MainSelect"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"PriorLevel"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"FuncRoleHierarchicalSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"funcRoleHierSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"funcRoleHierSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"PriorLevel"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token string" style=color:#e3116c>"DependentUserSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"mainSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"mainSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"mainSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Level"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"MainSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"mainSelect"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"mainSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysUserId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ChiefUnitsSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AllUnits"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AllUnits"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"userInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token string" style=color:#e3116c>"UserUnits"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ChiefUnitsSelect"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserUnits"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysUserInRole"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserInRole"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserUnits"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserUnits"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserInRole"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysUserId"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">                            </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"UserUnits"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AllUnits"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Granted"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Level"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            IsGranted</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            NestLevel</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"HierarchicalSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"HierarchicalSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"HierarchicalSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"HierarchicalSelect"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UserId</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"FuncRoleHierarchicalSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"FuncRoleHierarchicalSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"FuncRoleHierarchicalSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"FuncRoleHierarchicalSelect"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"DependentUserSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"DependentUserSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"DependentUserSelect"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"DependentUserSelect"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    DependentUsersList :</span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DependentUsersList'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> NestLevel </span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"> DependentUser </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> DependentUsersList </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXIT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> DependentUser </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        DependentUserId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> DependentUser</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        PERFORM </span><span class="token string" style=color:#e3116c>"tsp_GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">DependentUserId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> NestLevel </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    GetGrantorSysAdminUnitList :</span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'GetGrantorSysAdminUnitList'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> NestLevel </span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FOR</span><span class="token plain"> GrantorSysAdminUnit </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> GetGrantorSysAdminUnitList </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXIT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> GrantorSysAdminUnit </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        GrantorSysAdminUnitId </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> GrantorSysAdminUnit</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        PERFORM </span><span class="token string" style=color:#e3116c>"tsp_GetAdminUnitList"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">GrantorSysAdminUnitId</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> NestLevel </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>LOOP</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> NestLevel </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> QUERY</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"QQ"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"QQ"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"QQ"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DISTINCT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Name"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"ParentRoleId"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INNER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>JOIN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"SysAdminUnit"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"sau"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"AdminUnitList"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"Id"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"QQ"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>ORDER</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BY</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"QQ"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"SysAdminUnitTypeValue"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>DESC</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$$ </span><span class="token keyword" style=color:#00009f>LANGUAGE</span><span class="token plain"> plpgsql</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-2139-5>Example 5 (stored procedures)<a href=#title-2139-5 class=hash-link aria-label="Direct link to Example 5 (stored procedures)" title="Direct link to Example 5 (stored procedures)">​</a></h2>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class=admonitionHeading_TMsN>Example</div><div class=admonitionContent_vXIg><p>Example of a stored procedure that uses exception handling and executes a custom script.</div></div>
<div class="tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Microsoft SQL<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">PostgreSQL</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Stored procedure that uses exception handling and executes a custom script</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- Microsoft SQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> sys</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">objects </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> object_id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">N</span><span class="token string" style=color:#e3116c>'[dbo].[tsp_CanConvertData]'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">N</span><span class="token string" style=color:#e3116c>'P'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'PC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PROCEDURE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_CanConvertData</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>PROCEDURE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">tsp_CanConvertData</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>@EntitySchemaName</span><span class="token plain"> SYSNAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>@SourceColumnName</span><span class="token plain"> SYSNAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>@NewColumnDataType</span><span class="token plain"> SYSNAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>OUT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> NOCOUNT </span><span class="token keyword" style=color:#00009f>ON</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@sql</span><span class="token plain"> NVARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">MAX</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@unicodeCharLength</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> SYSNAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dataTypeSize</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dataTypePrecision</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UPPER</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">DATA_TYPE</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token variable" style=color:#36acaa>@dataTypeSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> CHARACTER_MAXIMUM_LENGTH </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> NUMERIC_PRECISION</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> CHARACTER_MAXIMUM_LENGTH</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token variable" style=color:#36acaa>@dataTypePrecision</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ISNULL</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">NUMERIC_SCALE</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> INFORMATION_SCHEMA</span><span class="token punctuation" style=color:#393A34>.</span><span class="token keyword" style=color:#00009f>COLUMNS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> TABLE_NAME </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@EntitySchemaName</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> COLUMN_NAME </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SourceColumnName</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> SYSNAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypePrecision</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DEClARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token plain"> NVARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">MAX</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CHARINDEX</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'('</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewColumnDataType</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewColumnDataType</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypePrecision</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> UPPER</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">LTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">RTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SUBSTRING</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@NewColumnDataType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> LTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">RTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SUBSTRING</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@NewColumnDataType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token function" style=color:#d73a49>LEN</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@NewColumnDataType</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CHARINDEX</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>')'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> LTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">RTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SUBSTRING</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CHARINDEX</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>','</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CAST</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">LTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">RTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SUBSTRING</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypePrecision</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CAST</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">LTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">RTRIM</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">SUBSTRING</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@i</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token function" style=color:#d73a49>LEN</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypePrecision</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">UPPER</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'MAX'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> CAST</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@newDataTypeSizeDefinition</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ImplicitDataConvertTable</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        SourceDataType SYSNAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        DestinationDataType SYSNAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ImplicitDataConvertTable</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UNIQUEIDENTIFIER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UNIQUEIDENTIFIER'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UNIQUEIDENTIFIER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UNIQUEIDENTIFIER'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATETIME2'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATETIME2'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATETIME2'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATETIME2'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATETIME2'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATETIME2'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATETIME2'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UNIQUEIDENTIFIER'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ImplicitDataConvertTable</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SourceDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> DestinationDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ImplicitDataOverflowConvertTable</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        SourceDataType SYSNAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        DestinationDataType SYSNAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ImplicitDataOverflowConvertTable</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UNIQUEIDENTIFIER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UNIQUEIDENTIFIER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BIT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>UNION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ALL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ImplicitDataOverflowConvertTable</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SourceDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> DestinationDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@sql</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'IF EXISTS(SELECT * FROM ['</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@EntitySchemaName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>']) SET @Result = 0 ELSE SET @Result = 1'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> sp_executesql </span><span class="token variable" style=color:#36acaa>@sql</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'@Result BIT OUT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>OUT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"> TRY</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DECIMAL'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@cnt</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ConvertDescription</span><span class="token plain"> NVARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">MAX</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ConvertDescription</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CONVERT('</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@NewColumnDataType</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token string" style=color:#e3116c>', ['</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SourceColumnName</span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'])'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@sql</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'IF EXISTS(SELECT * FROM ['</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@EntitySchemaName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">\</span><span class="token operator" style=color:#393A34>*</span><span class="token string" style=color:#e3116c>'] WHERE '</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token variable" style=color:#36acaa>@ConvertDescription</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>' = '</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ConvertDescription</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>') SET @cnt = 1 ELSE SET @cnt = 0'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> sp_executesql </span><span class="token variable" style=color:#36acaa>@sql</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'@cnt INT OUT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@cnt</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@cnt</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>OUT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dl</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@sql</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'SELECT @dl = MAX(DATALENGTH(['</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@SourceColumnName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'])) '</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token string" style=color:#e3116c>'FROM ['</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@EntitySchemaName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>']'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>EXEC</span><span class="token plain"> sp_executesql </span><span class="token variable" style=color:#36acaa>@sql</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'@dl INT OUT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dl</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@dl</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>OUT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'VARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'VARBINARY'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dl</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token variable" style=color:#36acaa>@newDataTypeName</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NVARCHAR'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NCHAR'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@dl</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>/</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@unicodeCharLength</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@newDataTypeSize</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                    </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> TRY</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"> CATCH</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> CATCH</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Stored procedure that uses exception handling and executes a custom scrip</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- PostgreSQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>public</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"tsp_CanConvertData"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>CASCADE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>public</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"tsp_CanConvertData"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    EntitySchemaName NAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    SourceColumnName NAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    NewColumnDataType NAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    CanConvert </span><span class="token keyword" style=color:#00009f>OUT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> $BODY$</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    dataTypeName NAME</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    newDataTypeName NAME</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    newDataTypeSize </span><span class="token keyword" style=color:#00009f>INTEGER</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    countRow </span><span class="token keyword" style=color:#00009f>INTEGER</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    dataLength </span><span class="token keyword" style=color:#00009f>INTEGER</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    convertDescription </span><span class="token keyword" style=color:#00009f>TEXT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    unicodeCharLength </span><span class="token keyword" style=color:#00009f>INTEGER</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    sqlQuery </span><span class="token keyword" style=color:#00009f>TEXT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    castQuery </span><span class="token keyword" style=color:#00009f>TEXT</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    dataTypeName </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> UPPER</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">data_type</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> information_schema</span><span class="token punctuation" style=color:#393A34>.</span><span class="token keyword" style=color:#00009f>columns</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> table_name </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> EntitySchemaName </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> column_name </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> SourceColumnName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> dataTypeName </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"fn_ParseDataType"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">DataTypeName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"fn_ParseDataType"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">DataTypeSize</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>public</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"fn_ParseDataType"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">NewColumnDataType</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> newDataTypeName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> newDataTypeSize</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NotConvertTable"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NotConvertTable"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        SourceDataType NAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        DestinationDataType NAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NotConvertTable"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> SourceDataType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> DestinationDataType </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"NotConvertTable"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SourceDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> dataTypeName </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> DestinationDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> newDataTypeName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> ImplicitDataConvertTable</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> ImplicitDataConvertTable </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        SourceDataType NAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        DestinationDataType NAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> ImplicitDataConvertTable </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> SourceDataType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> DestinationDataType </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> ImplicitDataConvertTable</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SourceDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> dataTypeName </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> DestinationDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> newDataTypeName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>TRUE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>EXECUTE</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>FORMAT</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'SELECT count(*) FROM %1$I'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> EntitySchemaName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> countRow</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">countRow </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> CanConvert </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ExplicitDataConvertTable"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ExplicitDataConvertTable"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        SourceDataType NAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        DestinationDataType NAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ExplicitDataConvertTable"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'INTEGER'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'UUID'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIMESTAMP WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'DATE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'TIME WITHOUT TIME ZONE'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BOOLEAN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> SourceDataType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> DestinationDataType </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ExplicitDataConvertTable"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SourceDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> dataTypeName </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> DestinationDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> newDataTypeName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        castQuery </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>FORMAT</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CAST(%1$I%3$s AS %2$s)'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SourceColumnName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> NewColumnDataType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>CASE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> dataTypeName </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'::TEXT'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> dataTypeName </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'NUMERIC'</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'::INTEGER'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>''</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        sqlQuery </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>FORMAT</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'SELECT COUNT(*) FROM %1$I WHERE %2$s = %2$s'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            EntitySchemaName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> castQuery</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>EXECUTE</span><span class="token plain"> sqlQuery</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>TRUE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        EXCEPTION </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> OTHERS </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ImplicitDataOverflowConvertTable"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TEMP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>TABLE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ImplicitDataOverflowConvertTable"</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        SourceDataType NAME</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        DestinationDataType NAME</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>INSERT</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ImplicitDataOverflowConvertTable"</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VALUES</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'TEXT'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'BYTEA'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'CHARACTER VARYING'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> SourceDataType</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> DestinationDataType </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ImplicitDataOverflowConvertTable"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> SourceDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> dataTypeName </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> DestinationDataType </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> newDataTypeName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>EXECUTE</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>FORMAT</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'SELECT count(*) FROM %1$I'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> EntitySchemaName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> countRow</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">countRow </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> CanConvert </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>EXECUTE</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>FORMAT</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>'SELECT MAX(PG_COLUMN_SIZE(%1$I)) FROM %2$I'</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SourceColumnName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> EntitySchemaName</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>INTO</span><span class="token plain"> dataLength</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">dataLength </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> newDataTypeSize</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>TRUE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        EXCEPTION </span><span class="token keyword" style=color:#00009f>WHEN</span><span class="token plain"> OTHERS </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            CanConvert </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$BODY$</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>LANGUAGE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'plpgsql'</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=title-2139-6>Example 6 (functions)<a href=#title-2139-6 class=hash-link aria-label="Direct link to Example 6 (functions)" title="Direct link to Example 6 (functions)">​</a></h2>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class=admonitionHeading_TMsN>Example</div><div class=admonitionContent_vXIg><p>Example of a function.</div></div>
<div class="tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Microsoft SQL<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">PostgreSQL</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Function</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- Microsoft SQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>SELECT</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FROM</span><span class="token plain"> sys</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">objects</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>WHERE</span><span class="token plain"> object_id </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">N</span><span class="token string" style=color:#e3116c>'[dbo].[fn_IsGuid]'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>AND</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>type</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> N</span><span class="token string" style=color:#e3116c>'FN'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">fn_IsGuid</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">dbo</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">fn_IsGuid</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token plain"> NVARCHAR</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">MAX</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>RETURNS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasLeftBraces</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>LIKE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'{%'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> SUBSTRING</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>LEN</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasLeftBraces</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasLeftBraces</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasRightBraces</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>LIKE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'%}'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> SUBSTRING</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>LEN</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasRightBraces</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasRightBraces</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>DECLARE</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BIT</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@ValidateValue</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>LIKE</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'[0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F]-[0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F]-[0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F]-[0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F]-[0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F]'</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasLeftBraces</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@hasRightBraces</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>SET</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>@Result</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">GO</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_m3Ux><pre tabindex=0 class="prism-code language-sql codeBlock_qGQc thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_p187><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-- Function</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>-- PostgreSQL</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>DROP</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>EXISTS</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"public"</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"fn_IsGuid"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>CREATE</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>OR</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>REPLACE</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>FUNCTION</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>public</span><span class="token punctuation" style=color:#393A34>.</span><span class="token string" style=color:#e3116c>"fn_IsGuid"</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ValidateValue </span><span class="token operator" style=color:#393A34>IN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>VARCHAR</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>RETURNS</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>BOOLEAN</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>AS</span><span class="token plain"> $$</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>BEGIN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>IF</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">regexp_matches</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ValidateValue</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'^\{?[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\}?$'</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>IS</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>NOT</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>NULL</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>THEN</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>TRUE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>ELSE</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>RETURN</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>FALSE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>END</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>IF</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>END</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">$$ </span><span class="token keyword" style=color:#00009f>LANGUAGE</span><span class="token plain"> plpgsql</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre><div class=buttonGroup_6DOT><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_eSgA aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_y97N><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_LjdS><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=resources>Resources<a href=#resources class=hash-link aria-label="Direct link to Resources" title="Direct link to Resources">​</a></h2>
<p><a href=https://www.postgresql.org/docs/current/ target=_blank rel="noopener noreferrer">Official PostgreSQL documentation</a></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/docs/8.x/dev/development-on-creatio-platform/database-features-examples><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Examples</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/docs/8.x/dev/development-on-creatio-platform/development-tools/database-tools/backward-compatible-sql-scripts><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Backward compatible scripts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#title-2139-1 class="table-of-contents__link toc-highlight">Example 1 (views)</a><li><a href=#title-2139-2 class="table-of-contents__link toc-highlight">Example 2 (views)</a><li><a href=#title-2139-3 class="table-of-contents__link toc-highlight">Example 3 (stored procedures)</a><li><a href=#title-2139-4 class="table-of-contents__link toc-highlight">Example 4 (stored procedures)</a><li><a href=#title-2139-5 class="table-of-contents__link toc-highlight">Example 5 (stored procedures)</a><li><a href=#title-2139-6 class="table-of-contents__link toc-highlight">Example 6 (functions)</a><li><a href=#resources class="table-of-contents__link toc-highlight">Resources</a></ul></div></div></div></div></main></div></div></div></div><footer class=footer><div class=footer__top><div class="container container-fluid"><div class=footer__cont><div class=footer__logo><img src=/docs/8.x/dev/img/accelerate.svg alt="" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width=271.4 height=38><img src=/docs/8.x/dev/img/accelerate.svg alt="" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width=271.4 height=38></div><div class="row footer__links"><div class="col footer__col"><ul class="footer__items clean-list"><li class=footer__item><a href=https://www.facebook.com/CreatioCompany target=_blank rel="noopener noreferrer" class=footer__link-item>Facebook<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.linkedin.com/company/creatioglobal target=_blank rel="noopener noreferrer" class=footer__link-item>LinkedIn<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.youtube.com/c/creatio target=_blank rel="noopener noreferrer" class=footer__link-item>YouTube<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.twitter.com/Creatio_Global target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.owler.com/company/Creatio target=_blank rel="noopener noreferrer" class=footer__link-item>Owler<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_nPIU><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Connect with us</div><ul class="footer__items clean-list"><li class=footer__item><a href="tel:+1 617 765 7997" target=_blank rel="noopener noreferrer" class=footer__link-item>US: +1 617 765 7997</a><li class=footer__item><a href="tel:+44 20 3384 0040" target=_blank rel="noopener noreferrer" class=footer__link-item>UK: +44 20 3384 0040</a><li class=footer__item><a href="tel:+61 261 452 888" target=_blank rel="noopener noreferrer" class=footer__link-item>AU: +61 261 452 888</a></ul></div><div class="col footer__col"><div class=footer__title> </div><ul class="footer__items clean-list"><li class=footer__item><a href=mailto:info@creatio.com target=_blank rel="noopener noreferrer" class=footer__link-item>info@creatio.com</a><li class=footer__item><a href=mailto:info@creatio.com target=_blank rel="noopener noreferrer" class=footer__link-item>support@creatio.com</a></ul></div></div></div></div></div><div class=footer__bottom><div class="container container-fluid"><div class=footer__copyright>© 2025 Creatio. All rights reserved.  |  <a href=https://www.creatio.com/privacy-policy target=_blank>Privacy Policy</a></div></div></div></footer></div>